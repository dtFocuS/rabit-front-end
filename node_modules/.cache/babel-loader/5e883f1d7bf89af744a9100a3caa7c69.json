{"ast":null,"code":"var _jsxFileName = \"/Users/dannytseng/Development/mod4/rabit-front-end/rabit-client/src/components/Login.js\";\nimport React, { Component } from 'react';\nimport '../index.css';\nimport SignupForm from '../components/SignupForm';\nimport { BrowserRouter as Route, withRouter } from 'react-router-dom';\n\nclass Login extends Component {\n  constructor() {\n    super();\n    this.state = {\n      modalShow: false\n    };\n\n    this.login = ev => {\n      ev.preventDefault();\n      console.log('log in');\n      let username = this.username.current.value;\n      let password = this.password.current.value;\n      fetch('http://localhost:3000/api/v1/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user: {\n            username,\n            password\n          }\n        })\n      }).then(res => res.json()).then(json => {\n        console.log('login:', json);\n\n        if (json && json.jwt) {\n          this.saveToken(json.jwt);\n          this.getProfile();\n        }\n      }).then(() => {\n        this.props.history.push('/');\n      });\n    };\n\n    this.username = React.createRef();\n    this.password = React.createRef();\n\n    if (this.getToken()) {\n      this.getProfile();\n    }\n\n    this.logout = this.logout.bind(this);\n  }\n\n  logout() {\n    this.clearToken();\n    this.setState({\n      user: null\n    });\n  } // getProfile = () => {\n  // \tlet token = this.getToken()\n  // \tfetch('http://localhost:3000/api/v1/profile', {\n  // \t\theaders: {\n  // \t\t\t'Authorization': 'Bearer ' + token\n  // \t\t}\n  // \t})\n  // \t.then(res => res.json())\n  // \t.then(json => {\n  // \t\t\tconsole.log('profile:', json)\n  // \t\t\tthis.setState({ user: json.user }, () => {this.props.onGetUser(this.state)})\n  // \t})\n  // }\n\n\n  saveToken(jwt) {\n    localStorage.setItem('jwt', jwt);\n  }\n\n  clearToken(jwt) {\n    localStorage.setItem('jwt', '');\n  }\n\n  getToken(jwt) {\n    return localStorage.getItem('jwt');\n  } // handleCreate = (newUser) => {\n  // \tfetch('http://localhost:3000/api/v1/users', {\n  // \t\tmethod: \"POST\",\n  // \t\theaders: {\n  // \t\t\t'Content-Type': 'application/json'\n  // \t\t},\n  // \t\tbody: JSON.stringify({ user: {...newUser } })\n  // \t})\n  // \t.then(resp => resp.json())\n  // \t.then(json => {this.setState({ user: json.user })})\n  // }\n\n\n  loginForm() {\n    let modalClose = () => this.setState({\n      modalShow: false\n    });\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      onSubmit: this.login,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"border-top-0 border-right-0 border-left-0\",\n      id: \"username-entry\",\n      type: \"text\",\n      placeholder: \"username\",\n      ref: this.username,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      className: \"border-top-0 border-right-0 border-left-0\",\n      id: \"password-entry\",\n      type: \"password\",\n      placeholder: \"password\",\n      ref: this.password,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      id: \"submit-button\",\n      type: \"submit\",\n      value: \"log in\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"sign-up\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Don't have an account? \", React.createElement(\"span\", {\n      id: \"sign-up-button\",\n      onClick: () => this.setState({\n        modalShow: true\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Sign Up\")), React.createElement(SignupForm, {\n      show: this.state.modalShow,\n      onHide: modalClose,\n      onCreate: this.handleCreate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    })));\n  }\n\n  logoutArea() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"logged-in-username\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, this.state.user && \"@\" + this.state.user.username || null), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), this.state.user ? React.createElement(\"button\", {\n      id: \"logout-button\",\n      type: \"button\",\n      onClick: this.logout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"log out\") : null);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, this.state.user ? this.logoutArea() : this.loginForm());\n  }\n\n}\n\n;\nexport default withRouter(Login);","map":{"version":3,"sources":["/Users/dannytseng/Development/mod4/rabit-front-end/rabit-client/src/components/Login.js"],"names":["React","Component","SignupForm","BrowserRouter","Route","withRouter","Login","constructor","state","modalShow","login","ev","preventDefault","console","log","username","current","value","password","fetch","method","headers","body","JSON","stringify","user","then","res","json","jwt","saveToken","getProfile","props","history","push","createRef","getToken","logout","bind","clearToken","setState","localStorage","setItem","getItem","loginForm","modalClose","handleCreate","logoutArea","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport '../index.css';\nimport SignupForm from '../components/SignupForm';\n\nimport { BrowserRouter as Route, withRouter } from 'react-router-dom';\n\nclass Login extends Component {\n\tstate = {\n\t\tmodalShow: false\n\t}\n\n\tconstructor() {\n\t\tsuper()\n\t\tthis.username = React.createRef()\n\t\tthis.password = React.createRef()\n\n\t\tif (this.getToken()) {\n\t\t\tthis.getProfile()\n\t\t}\n\n\t\tthis.logout = this.logout.bind(this)\n\t}\n\n\tlogin = (ev) => {\n\t\tev.preventDefault()\n\t\tconsole.log('log in')\n\n\t\tlet username = this.username.current.value\n\t\tlet password = this.password.current.value\n\n\t\tfetch('http://localhost:3000/api/v1/login', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tbody: JSON.stringify({ user: { username, password } })\n\t\t})\n\t\t.then(res => res.json())\n\t\t.then(json => {\n\t\t\tconsole.log('login:', json)\n\t\t\tif (json && json.jwt) {\n\t\t\t\tthis.saveToken(json.jwt)\n\t\t\t\tthis.getProfile()\n\t\t\t}\n\t\t})\n\t\t.then(() => {\n\t\t\tthis.props.history.push('/')\n\t\t})\n\t}\n\n\tlogout() {\n\t\tthis.clearToken();\n\t\tthis.setState({ user: null })\n\t}\n\n\t// getProfile = () => {\n\t// \tlet token = this.getToken()\n\t// \tfetch('http://localhost:3000/api/v1/profile', {\n\t// \t\theaders: {\n\t// \t\t\t'Authorization': 'Bearer ' + token\n\t// \t\t}\n\t// \t})\n\t// \t.then(res => res.json())\n\t// \t.then(json => {\n\t// \t\t\tconsole.log('profile:', json)\n\t// \t\t\tthis.setState({ user: json.user }, () => {this.props.onGetUser(this.state)})\n\t// \t})\n\t// }\n\n\tsaveToken(jwt) {\n\t\tlocalStorage.setItem('jwt', jwt)\n\t}\n\n\tclearToken(jwt) {\n\t\tlocalStorage.setItem('jwt', '')\n\t}\n\n\tgetToken(jwt) {\n\t\treturn localStorage.getItem('jwt')\n\t}\n\n\t// handleCreate = (newUser) => {\n\t// \tfetch('http://localhost:3000/api/v1/users', {\n\t// \t\tmethod: \"POST\",\n\t// \t\theaders: {\n\t// \t\t\t'Content-Type': 'application/json'\n\t// \t\t},\n\t// \t\tbody: JSON.stringify({ user: {...newUser } })\n\t// \t})\n\t// \t.then(resp => resp.json())\n\t// \t.then(json => {this.setState({ user: json.user })})\n\n\t// }\n\n\tloginForm() {\n\t\tlet modalClose = () => this.setState({ modalShow: false });\n\t\treturn <div>\n\t\t\t<form onSubmit={this.login}>\n\t\t\t\t<input className=\"border-top-0 border-right-0 border-left-0\"id=\"username-entry\" type=\"text\" placeholder=\"username\" ref={this.username} /><br/><br/>\n\t\t\t\t<input className=\"border-top-0 border-right-0 border-left-0\" id=\"password-entry\" type=\"password\" placeholder=\"password\" ref={this.password} /><br/><br/>\n\t\t\t\t<input id=\"submit-button\" type=\"submit\" value=\"log in\" /><br/>\n\t\t\t</form><br/>\n\t\t\t<div id=\"sign-up\">\n\t\t\t\t\t<p>Don't have an account? <span id=\"sign-up-button\" onClick={() => this.setState({ modalShow: true })}>Sign Up</span></p>\n\t\t\t\t\t<SignupForm\n\t\t\t\t\t\tshow={this.state.modalShow}\n\t\t\t\t\t\tonHide={modalClose}\n\t\t\t\t\t\tonCreate={this.handleCreate}\n\t\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t}\n\n\tlogoutArea() {\n\t\treturn <div>\n\t\t\t<div id=\"logged-in-username\">\n\t\t\t\t{this.state.user && \"@\" + this.state.user.username || null}\n\t\t\t</div>\n\n\t\t\t<br/>\n\t\t\t{this.state.user? <button id=\"logout-button\" type=\"button\" onClick={this.logout}>log out</button> : null}\n\t\t</div>\n\t}\n\n\trender(){\n  \t\treturn (\n\t\t \t<div className=\"App\">\n\n\t\t\t\t{this.state.user ? this.logoutArea() : this.loginForm()}\n\n\t\t\t</div>\n  \t\t);\n  \t}\n};\n\nexport default withRouter(Login);\n"]},"metadata":{},"sourceType":"module"}